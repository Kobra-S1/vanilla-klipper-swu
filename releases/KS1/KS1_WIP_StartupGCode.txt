; Start G-code
G90                                   ; absolute positioning
M83                                   ; extruder relative mode

; — Preheat (no waiting yet) —
M140 S[first_layer_bed_temperature]    ; set bed temp (no wait)
M104 S150                              ; set temporary nozzle temp to prevent oozing
G4 S10                                 ; dwell 10 s to warm nozzle
; — Home axes —
G28 Y
G28 X
G28 Z
G1 Z10 F240                            ; raise Z by 10 mm (1 cm) instead of 50 mm
TO_THROW_POSITION                      ; move into purge corner

M109 S150  ; wait for nozzle to HEAT (skips if already ≥ target)
M190 S[first_layer_bed_temperature]       ; wait for bed to HEAT (skips if already ≥ target)

WIPE_ENTER
WIPE_NOZZLE
WIPE_STOP
WIPE_EXIT

G28 Z

;BED_MESH_CALIBRATE
BED_MESH_CALIBRATE PROFILE=adaptive ADAPTIVE=1
; — Move to wipe/prime area —
TO_THROW_POSITION 

M109 S[nozzle_temperature_initial_layer]; wait for nozzle to HEAT (skips if already ≥ target)
M190 S[first_layer_bed_temperature]       ; wait for bed to HEAT (skips if already ≥ target)

;Extrude some filament
G92 E0                                ; reset extruder
G1 E50 F400
G1 E60 F150
G1 E-2 F7000
G92 E0

;Clean nozzle after extruding
 WIPE_ENTER
 WIPE_NOZZLE
 WIPE_STOP
WIPE_EXIT
TO_THROW_POSITION 
; — First-layer setup —
G1 Z2 F240
G1 X2 Y10 F3000
G1 Z0.28 F240                         ; move to first-layer height
G92 E0                                ; reset extruder
G1 Y140 E10 F1500                     ; prime line
G1 X2.3 F5000
G92 E0
G1 Y10 E10 F1200                      ; re-prime
G92 E0


